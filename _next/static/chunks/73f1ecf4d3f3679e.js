(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,86826,15089,e=>{"use strict";e.i(47167);let t="https://backend.vibemakers.kr",s="moducon_sessions",a="moducon_sessions_timestamp",r="moducon_sessions_version";async function n(e){try{let t=localStorage.getItem(s),n=localStorage.getItem(a);if("2.0"!==localStorage.getItem(r)&&(console.log("캐시 버전 불일치, 무효화"),i()),t&&n){let s=Date.now()-parseInt(n);if(s<3e5){console.log(`캐시 히트 (${Math.floor(s/1e3)}초 전)`);let a=JSON.parse(t);return e?a.filter(t=>t.track===e):a}console.log("캐시 만료")}let o=await l();return localStorage.setItem(s,JSON.stringify(o)),localStorage.setItem(a,Date.now().toString()),localStorage.setItem(r,"2.0"),console.log(`캐시 저장 (${o.length}개 세션)`),e?o.filter(t=>t.track===e):o}catch(t){console.error("세션 로딩 실패:",t);{let t=localStorage.getItem(s);if(t){console.warn("오프라인 모드: 캐시 데이터 사용");let s=JSON.parse(t);return e?s.filter(t=>t.track===e):s}}throw t}}async function l(e){let s=e?`${t}/api/sessions?track=${encodeURIComponent(e)}`:`${t}/api/sessions`,a=await fetch(s);if(!a.ok)throw Error(`세션 데이터 로딩 실패: ${a.status}`);let r=await a.json();return r.data||r}function i(){localStorage.removeItem(s),localStorage.removeItem(a),localStorage.removeItem(r),console.log("캐시 무효화 완료")}function o(e){let[t,s]=e.split("-").map(e=>e.trim());return{startTime:t||"",endTime:s||""}}e.s(["fetchSessionsWithCache",()=>n,"invalidateSessionsCache",()=>i],86826),e.s(["parseTimeSlot",()=>o],15089)},48168,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(18566),r=e.i(22016),n=e.i(86826),l=e.i(15089);function i(){let e=(0,a.useRouter)(),i=(0,a.useParams)().code,[o,c]=(0,s.useState)(null),[d,m]=(0,s.useState)([]),[x,h]=(0,s.useState)(!0),[g,p]=(0,s.useState)(!0),[u,f]=(0,s.useState)(null),[y,j]=(0,s.useState)(new Set),[b,v]=(0,s.useState)("popular"),N="https://backend.vibemakers.kr";(0,s.useEffect)(()=>{if(!localStorage.getItem("admin_token"))return void e.push("/admin/login")},[e]),(0,s.useEffect)(()=>{(async()=>{try{let e=(await (0,n.fetchSessionsWithCache)()).find(e=>e.code===i);e?c(e):f("세션을 찾을 수 없습니다.")}catch(e){console.error("세션 로딩 실패:",e),f("세션 데이터를 불러올 수 없습니다.")}finally{h(!1)}})()},[i]);let S=(0,s.useCallback)(async()=>{if(o){p(!0);try{let e=await fetch(`${N}/api/sessions/${o.id}/questions?sort=${b}&limit=100`),t=await e.json();e.ok?m(t.data.questions||[]):console.error("질문 로딩 실패:",t)}catch(e){console.error("질문 로딩 실패:",e)}finally{p(!1)}}},[N,o,b]);(0,s.useEffect)(()=>{o&&S()},[o,S]);let w=async t=>{if(!confirm("이 질문을 삭제하시겠습니까?"))return;let s=localStorage.getItem("admin_token");if(!s){alert("관리자 인증이 필요합니다."),e.push("/admin/login");return}j(e=>new Set(e).add(t));try{let e=await fetch(`${N}/api/admin/questions/${t}`,{method:"DELETE",headers:{"x-admin-token":s}});if(e.ok)m(e=>e.filter(e=>e.id!==t));else{let t=await e.json();alert(t.error?.message||"삭제에 실패했습니다.")}}catch(e){console.error("삭제 실패:",e),alert("삭제에 실패했습니다.")}finally{j(e=>{let s=new Set(e);return s.delete(t),s})}};if(x)return(0,t.jsx)("div",{className:"min-h-[100dvh] bg-gray-50 flex items-center justify-center",children:(0,t.jsx)("div",{className:"text-gray-500",children:"로딩 중..."})});if(u||!o)return(0,t.jsx)("div",{className:"min-h-[100dvh] bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-red-500 mb-4",children:u||"세션을 찾을 수 없습니다."}),(0,t.jsx)(r.default,{href:"/admin/sessions",className:"text-gray-600 hover:text-gray-900",children:"← 목록으로 돌아가기"})]})});let{startTime:k,endTime:$}=(0,l.parseTimeSlot)(o.timeSlot);return(0,t.jsx)("div",{className:"min-h-[100dvh] bg-gray-50",children:(0,t.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)(r.default,{href:"/admin/sessions",className:"text-gray-600 hover:text-gray-900 text-sm mb-2 inline-block",children:"← 세션 목록"}),(0,t.jsx)("div",{className:"flex justify-between items-start",children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)("span",{className:"px-2 py-1 bg-gray-200 rounded text-gray-700 text-xs font-mono",children:o.code}),(0,t.jsx)("span",{className:"px-2 py-1 bg-gray-100 rounded text-gray-600 text-xs",children:o.track}),(0,t.jsxs)("span",{className:"text-gray-500 text-xs font-mono",children:[k,"-",$]})]}),(0,t.jsx)("h1",{className:"text-xl font-bold text-gray-900 mb-1",children:o.title}),(0,t.jsx)("p",{className:"text-gray-600 text-sm",children:o.speakerName})]})})]}),(0,t.jsxs)("div",{className:"bg-white rounded border border-gray-300",children:[(0,t.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[(0,t.jsxs)("h2",{className:"font-semibold text-gray-900",children:["질문 관리 (",d.length,"개)"]}),(0,t.jsxs)("div",{className:"flex gap-1 bg-gray-100 rounded-lg p-1",children:[(0,t.jsx)("button",{onClick:()=>v("popular"),className:`px-3 py-1 text-sm rounded-md transition-colors ${"popular"===b?"bg-white text-gray-900 shadow-sm font-medium":"text-gray-600 hover:text-gray-900"}`,children:"인기순"}),(0,t.jsx)("button",{onClick:()=>v("recent"),className:`px-3 py-1 text-sm rounded-md transition-colors ${"recent"===b?"bg-white text-gray-900 shadow-sm font-medium":"text-gray-600 hover:text-gray-900"}`,children:"최신순"})]})]}),g?(0,t.jsx)("div",{className:"p-8 text-center text-gray-500",children:"질문을 불러오는 중..."}):0===d.length?(0,t.jsx)("div",{className:"p-8 text-center text-gray-500",children:"등록된 질문이 없습니다."}):(0,t.jsx)("div",{className:"divide-y divide-gray-100",children:d.map(e=>{let s,a,r,n,l;return(0,t.jsxs)("div",{className:`px-6 py-4 ${e.isPinned?"bg-purple-50":""}`,children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[e.isPinned&&(0,t.jsx)("span",{className:"px-2 py-0.5 bg-purple-100 text-purple-700 text-xs rounded",children:"고정"}),e.isAnswered&&(0,t.jsx)("span",{className:"px-2 py-0.5 bg-green-100 text-green-700 text-xs rounded",children:"답변완료"}),e.isAnonymous&&(0,t.jsx)("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded",children:"익명"})]}),(0,t.jsx)("p",{className:"text-gray-800 mb-3 whitespace-pre-wrap",children:e.content}),(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 text-gray-500",children:[(0,t.jsx)("span",{children:e.author.name}),(0,t.jsx)("span",{children:"·"}),(0,t.jsx)("span",{children:(s=new Date(e.createdAt),r=Math.floor((a=new Date().getTime()-s.getTime())/6e4),n=Math.floor(a/36e5),l=Math.floor(a/864e5),r<1?"방금 전":r<60?`${r}분 전`:n<24?`${n}시간 전`:l<7?`${l}일 전`:s.toLocaleDateString("ko-KR"))}),(0,t.jsx)("span",{children:"·"}),(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),e.likeCount]})]}),(0,t.jsx)("button",{onClick:()=>w(e.id),disabled:y.has(e.id),className:"px-3 py-1 bg-red-100 text-red-700 text-sm rounded hover:bg-red-200 transition disabled:opacity-50",children:y.has(e.id)?"삭제 중...":"삭제"})]})]},e.id)})})]})]})})}e.s(["default",()=>i])}]);